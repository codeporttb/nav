<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bash — guest@nav: ~</title>
    <style>
        :root {
            --term-bg: #1c1c1c;
            --term-green: #4af626;
            --term-blue: #2980b9;
            --term-white: #eeeeee;
        }

        body, html {
            margin: 0; padding: 0;
            background-color: #000;
            height: 100%;
        }

        /* Terminal Window Styling */
        #terminal-window {
            background-color: var(--term-bg);
            color: var(--term-white);
            font-family: 'Cascadia Code', 'Ubuntu Mono', 'Courier New', monospace;
            font-size: 14px;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            padding: 10px;
            box-sizing: border-box;
        }

        .line { margin-bottom: 2px; line-height: 1.2; word-break: break-all; white-space: pre-wrap; }
        .system { color: var(--term-blue); }
        .data-val { color: #f1c40f; }

        /* The active input line */
        #input-line {
            display: flex;
            align-items: center;
            margin-top: 5px;
        }

        .prompt-text {
            color: var(--term-green);
            font-weight: bold;
            margin-right: 8px;
            white-space: nowrap;
        }

        input {
            background: transparent;
            border: none;
            color: var(--term-white);
            font-family: inherit;
            font-size: inherit;
            outline: none;
            flex: 1;
            padding: 0;
        }

        /* Help Manual Overlay */
        #help-manual {
            position: fixed; inset: 0;
            background: rgba(0,0,0,0.95);
            color: var(--term-white);
            padding: 30px;
            display: none;
            z-index: 1000;
            border: 1px solid #444;
        }

        .cmd-name { color: var(--term-blue); font-weight: bold; width: 100px; display: inline-block; }

        #boot-screen {
            position: fixed; inset: 0; background: #000;
            display: flex; align-items: center; justify-content: center; z-index: 2000;
        }
        
        button {
            background: #222; color: var(--term-green);
            border: 1px solid var(--term-green); padding: 10px 20px;
            font-family: inherit; cursor: pointer;
        }
    </style>
</head>
<body>

<div id="boot-screen">
    <button onclick="boot()">[ INITIALIZE TERMINAL ]</button>
</div>

<div id="terminal-window" onclick="focusInput()">
    <div class="line system">Linux nav-os 5.15.0-generic #1 SMP x86_64</div>
    <div class="line">Last login: Thu Feb 26 2026 on tty1</div>
    <div class="line">Type 'help' for navigation commands.</div>
    
    <div id="history"></div>

    <div id="input-line">
        <span class="prompt-text">guest@nav:~$</span>
        <input type="text" id="cmd-input" autofocus autocomplete="off" spellcheck="false">
    </div>
</div>

<div id="help-manual" onclick="this.style.display='none'">
    <h2 style="color: var(--term-blue)">NAV-SYSTEM MANUAL</h2>
    <hr>
    <div class="line"><span class="cmd-name">coords</span>  Current Lat/Lon position</div>
    <div class="line"><span class="cmd-name">speed</span>   Current ground speed (km/h)</div>
    <div class="line"><span class="cmd-name">compass</span> Heading and cardinal direction</div>
    <div class="line"><span class="cmd-name">alt</span>     Altitude above sea level</div>
    <div class="line"><span class="cmd-name">status</span>  GPS health and system uptime</div>
    <div class="line"><span class="cmd-name">clear</span>   Reset terminal display</div>
    <div class="line"><span class="cmd-name">exit</span>    Close manual</div>
    <p style="margin-top:20px; color: #666;">-- Click anywhere to return to shell --</p>
</div>

<script>
    const input = document.getElementById('cmd-input');
    const history = document.getElementById('history');
    const terminal = document.getElementById('terminal-window');
    
    let navData = { lat: 0, lon: 0, spd: 0, alt: 0, hdg: 0, acc: 0, start: Date.now() };

    function boot() {
        document.getElementById('boot-screen').style.display = 'none';
        input.focus();

        navigator.geolocation.watchPosition(p => {
            navData.lat = p.coords.latitude.toFixed(5);
            navData.lon = p.coords.longitude.toFixed(5);
            navData.spd = ((p.coords.speed || 0) * 3.6).toFixed(1);
            navData.alt = Math.round(p.coords.altitude || 0);
            navData.acc = Math.round(p.coords.accuracy);
        }, null, {enableHighAccuracy: true});

        window.addEventListener('deviceorientationabsolute', e => {
            navData.hdg = Math.round(e.webkitCompassHeading || (360 - e.alpha));
        });
    }

    function focusInput() { input.focus(); }

    input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            const cmd = input.value.trim().toLowerCase();
            if (cmd) execute(cmd);
            input.value = '';
            terminal.scrollTo(0, terminal.scrollHeight);
        }
    });

    function execute(cmd) {
        // Log the command to history
        const log = document.createElement('div');
        log.innerHTML = `<span class="prompt-text">guest@nav:~$</span> ${cmd}`;
        history.appendChild(log);

        // Process response
        const resp = document.createElement('div');
        resp.className = 'line';

        switch(cmd) {
            case 'help':
                document.getElementById('help-manual').style.display = 'block';
                return;
            case 'coords':
                resp.innerHTML = `LAT: <span class="data-val">${navData.lat}</span> | LON: <span class="data-val">${navData.lon}</span>`;
                break;
            case 'speed':
                resp.innerHTML = `SPEED: <span class="data-val">${navData.spd} km/h</span>`;
                break;
            case 'compass':
                const dirs = ["N", "NE", "E", "SE", "S", "SW", "W", "NW", "N"];
                const card = dirs[Math.round(navData.hdg / 45)];
                resp.innerHTML = `HEADING: <span class="data-val">${navData.hdg}° [${card}]</span>`;
                break;
            case 'alt':
                resp.innerHTML = `ALTITUDE: <span class="data-val">${navData.alt}m</span>`;
                break;
            case 'status':
                let up = Math.floor((Date.now() - navData.start)/1000);
                resp.innerHTML = `GPS_ACC: <span class="data-val">±${navData.acc}m</span> | UPTIME: <span class="data-val">${up}s</span>`;
                break;
            case 'clear':
                history.innerHTML = '';
                return;
            case 'exit':
                document.getElementById('help-manual').style.display = 'none';
                return;
            default:
                resp.innerHTML = `-bash: ${cmd}: command not found`;
        }
        history.appendChild(resp);
    }
</script>

</body>
</html>
